# ???? ??????? ???? ?????? - PulseX

## ?? ???? ????
?? ????? ???? ???? ???????? ???? ?????? ???????? ???????:
1. ???????? ???? ??????? ? ?????? OTP ???? ?? 4 ?????
2. ???????? ???? OTP ? ??? ?????? ?? ?????
3. ???????? ???? ???? ???? ????? ? ??? ????? ???? ??????

---

## ?? ??????? ????????

### Backend (?? ??????? ???????):
```
PulseX.Core/
??? Models/
?   ??? PasswordResetToken.cs                    [?]
??? DTOs/Auth/
?   ??? ForgotPasswordDto.cs                     [?]
?   ??? VerifyOtpDto.cs                          [?]
?   ??? ResetPasswordDto.cs                      [?]
??? Interfaces/
    ??? IPasswordResetRepository.cs              [?]
    ??? IEmailService.cs                         [?]

PulseX.Data/
??? Repositories/
    ??? PasswordResetRepository.cs               [?]

PulseX.API/
??? Services/
?   ??? EmailService.cs                          [?]
?   ??? PasswordResetService.cs                  [?]
??? Controllers/
?   ??? AuthController.cs                        [?? ??????? ?]
??? Program.cs                                    [?? ??????? ?]
??? appsettings.json                             [?? ??????? ?]
```

---

## ?? ????? ???????

### 1?? ????? Migration ???????
```bash
# ?? ???? Backend
cd PulseX.Data
dotnet ef migrations add AddPasswordResetToken --startup-project ../PulseX.API
dotnet ef database update --startup-project ../PulseX.API
```

### 2?? ????? ??????? ???????

???? `appsettings.json` ???? ??????? ???????:

#### ??????? Gmail (???????):
1. ???? ???? Gmail
2. ???? ???????? ???????? (2FA)
3. ???? ???: https://myaccount.google.com/apppasswords
4. ???? App Password ????
5. ???? ??? 16 ???

```json
"Email": {
  "SmtpHost": "smtp.gmail.com",
  "SmtpPort": "587",
  "Username": "your-email@gmail.com",
  "Password": "xxxx xxxx xxxx xxxx",  // ??? 16 ??? ???? ??????
  "FromEmail": "your-email@gmail.com",
  "FromName": "PulseX Support"
}
```

### 3?? ????? ????????
```bash
cd PulseX.API
dotnet run
```

---

## ?? ??? API Endpoints ???????

### 1. ????? OTP ???????
```
POST /api/auth/forgot-password
Content-Type: application/json

{
  "email": "user@example.com"
}
```

### 2. ?????? ?? OTP
```
POST /api/auth/verify-otp
Content-Type: application/json

{
  "email": "user@example.com",
  "otp": "1234"
}
```

### 3. ????? ????? ???? ??????
```
POST /api/auth/reset-password
Content-Type: application/json

{
  "email": "user@example.com",
  "otp": "1234",
  "newPassword": "NewPassword123!",
  "confirmPassword": "NewPassword123!"
}
```

---

## ?? ??????? ??????? ??? ????????

### ?? `ForgotPassword.jsx`:
```javascript
const handleSubmit = async (e) => {
  e.preventDefault();
  
  try {
    const response = await fetch('http://localhost:5000/api/auth/forgot-password', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email })
    });

    if (response.ok) {
      // ????? ????? ?????? ????? ???????
      navigate('/verify-code', { state: { email } });
    }
  } catch (err) {
    setError('??? ???. ???? ??? ????.');
  }
};
```

### ?? `VerifyCode.jsx`:
```javascript
const handleSubmit = async (e) => {
  e.preventDefault();
  
  try {
    const response = await fetch('http://localhost:5000/api/auth/verify-otp', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ 
        email: location.state?.email, 
        otp: code 
      })
    });

    if (response.ok) {
      // ????? ????? ????? ???????? ????? ??????? ???? OTP
      navigate('/reset-password', { 
        state: { 
          email: location.state?.email, 
          otp: code 
        } 
      });
    }
  } catch (err) {
    setError('??? ???. ???? ??? ????.');
  }
};
```

### ????? `ResetPassword.jsx`:
????? ????? ?? ??? Context ????? - ????? ???????? ?????? ?? ?????? ??? ???????.

### ?? React Router:
```javascript
<Route path="/forgot-password" element={<ForgotPassword />} />
<Route path="/verify-code" element={<VerifyCode />} />
<Route path="/reset-password" element={<ResetPassword />} />
```

---

## ? ?????? ??????

1. ??? ????? ???: `dotnet run`
2. ???? Swagger: http://localhost:5000/swagger
3. ??? ??? Flow:
   - POST `/api/auth/forgot-password` ?????? ?????
   - ???? ??????? ????? ??? ??? OTP
   - POST `/api/auth/verify-otp` ???????? ???? OTP
   - POST `/api/auth/reset-password` ????????? ???????
   - ??? ????? ?????? ????????? ??????

---

## ?? ?????? ??????

- ? ??? OTP ????? ??? 15 ?????
- ? ??? OTP ??????? ??? ????? ???
- ? ?????? ?? ??? ???? ?????? (6 ???? ??? ?????)
- ? ?????? ?? ????? ????? ??????
- ? ????? ???? ???????? ?? ActivityLog
- ? ??? ?????? ??? OTP ????????

---

## ?? ??? ??????? ???????

??????? ????? ???:
- ???? PulseX
- ????? ??????? ???? ????????
- ??? OTP ???? ???? ?????
- ????? ??? ????? ????? ??? 15 ?????
- ????? ??????? ?????? PulseX

---

## ? ??????? ????

1. **Gmail App Password**: 
   - ???? ???? 2FA ?????
   - ???????? 16 ??? (???? ??????)
   - ?? ?? ????? ???? ??? ???? ???????? ??

2. **?????? ??? OTP**:
   - 15 ????? ???
   - ?? ?????? ???? ???? ????

3. **??????**:
   - ???????? ???? 6 ???? ??? ?????
   - ?? ????? ????? ?? ActivityLog

---

## ?? ?? ??????? ???????

### ??????? ?? ??????
- ???? ?? ?????? SMTP ?? appsettings.json
- ???? ?? Gmail App Password ????
- ??? ??? ??? Console ?? VS ???????

### ??? OTP ????
- ???? ??? ???? 4 ????? ??????
- ???? ?? ??????? ??? ???? ???????? ?? ?????? ??????

### ??? OTP ??????
- ????? ?????? ??? 15 ?????
- ???? ??? ???? ?? ???? forgot-password

---

## ?? ????? ?????? ???????

????? ?? ????????? ????: `FORGOT_PASSWORD_SETUP.md`

---

**?? ??????? ?????? ???? PulseX** ??
